{% extends "base.html" %}

{% block title %}Customize - {{ super() }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12 mb-4">
        <h2><i data-feather="settings"></i> Customize Interface</h2>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Theme Color</h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="theme_color" class="form-label">Select Theme Color</label>
                        <input type="color" class="form-control form-control-color" id="theme_color" 
                               name="theme_color" value="{{ theme_color }}" title="Choose your theme color">
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i data-feather="settings"></i> Apply Color
                    </button>
                </form>

                <div class="mt-3">
                    <small class="text-muted">Quick Colors:</small>
                    <div class="d-flex gap-2 mt-2">
                        <button type="button" class="btn btn-sm btn-outline-secondary quick-color" data-color="#f8f9fa" style="background-color: #f8f9fa; width: 30px; height: 30px;" title="Light Gray"></button>
                        <button type="button" class="btn btn-sm btn-outline-secondary quick-color" data-color="#e3f2fd" style="background-color: #e3f2fd; width: 30px; height: 30px;" title="Light Blue"></button>
                        <button type="button" class="btn btn-sm btn-outline-secondary quick-color" data-color="#f3e5f5" style="background-color: #f3e5f5; width: 30px; height: 30px;" title="Light Purple"></button>
                        <button type="button" class="btn btn-sm btn-outline-secondary quick-color" data-color="#e8f5e8" style="background-color: #e8f5e8; width: 30px; height: 30px;" title="Light Green"></button>
                        <button type="button" class="btn btn-sm btn-outline-secondary quick-color" data-color="#fff3e0" style="background-color: #fff3e0; width: 30px; height: 30px;" title="Light Orange"></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Background</h5>
            </div>
            <div class="card-body">
                {% if background_url %}
                <div class="mb-3">
                    <small class="text-muted">Current Background:</small>
                    {% if bg_type == 'video' %}
                    <div class="mt-2">
                        <video controls style="width: 100%; max-height: 150px;">
                            <source src="{{ background_url }}" type="video/mp4">
                        </video>
                    </div>
                    {% else %}
                    <div class="mt-2">
                        <img src="{{ background_url }}" alt="Current background" 
                             style="width: 100%; max-height: 150px; object-fit: cover; border-radius: 5px;">
                    </div>
                    {% endif %}
                    
                    <form method="POST" class="mt-2">
                        <button type="submit" name="remove_background" class="btn btn-sm btn-outline-danger">
                            <i data-feather="trash"></i> Remove Background
                        </button>
                    </form>
                </div>
                {% endif %}

                <form method="POST" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="background" class="form-label">Upload New Background</label>
                        <input type="file" class="form-control" id="background" name="background" 
                               accept="image/*,video/mp4">
                        <div class="form-text">
                            Supported formats: PNG, JPG, JPEG, GIF, MP4
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i data-feather="upload"></i> Upload Background
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Preview</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">Changes are applied immediately. Navigate to other pages to see the updated theme and background.</p>
                <a href="{{ url_for('index') }}" class="btn btn-outline-primary">
                    <i data-feather="eye"></i> View Inventory
                </a>
                <a href="{{ url_for('analyze') }}" class="btn btn-outline-primary">
                    <i data-feather="bar-chart-2"></i> View Analytics
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function setColor(color) {
    document.getElementById('theme_color').value = color;
    // Trigger the input event to update preview
    document.getElementById('theme_color').dispatchEvent(new Event('input'));
}

// Preview color changes in real-time
document.getElementById('theme_color').addEventListener('input', function(e) {
    document.documentElement.style.setProperty('--custom-theme-color', e.target.value);
});

// Handle quick color button clicks
document.addEventListener('DOMContentLoaded', function() {
    const quickColorButtons = document.querySelectorAll('.quick-color');
    quickColorButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const color = this.getAttribute('data-color');
            setColor(color);
        });
    });
});
</script>
{% endblock %}
